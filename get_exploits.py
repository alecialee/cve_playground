"""
Alecia
Published: 3/29/2022

Querying GitHub Security Labs to get exploit CVEs.

End goal is to scrape the CVEs from the SecurityLab SecurityExploits folder.
"""

import json, requests
from bs4 import BeautifulSoup

response = requests.get("https://github.com/github/securitylab/tree/main/SecurityExploits")

# prints response
# print(response.text)

# prints response type
# print(type(response.text))

SE_folder = BeautifulSoup(response.text, 'html.parser')

# prints whole html doc
# print(SE_folder.prettify())

# prints all links listed with "CVE"
for link in SE_folder.find_all('a'):
        if ("CVE" in (link.get('href'))):
                print("\nhttps://github.com/" + link.get('href'))
                new_link = requests.get("https://github.com" + link.get('href'))
                cve_page = BeautifulSoup(new_link.text, 'html.parser')
                # print(cve_page.body.h2.text)
                print(cve_page.body.p.text)

